import unittest
from gauss import Gauss


class TestGauss(unittest.TestCase):
    def test_should_return_lower_matrix(self):
        matrix = [
            [1, 2, 3],
            [4, 5, 6],
            [7, 8, 9]
        ]

        expected = [
            [1., 0., 0.],
            [4., 1., 0.],
            [7., 2., 1.]
        ]
        gauss = Gauss()
        self.assertEqual(expected, gauss.lu_decomposition(matrix)[0])

    def test_should_return_upper_matrix(self):
        matrix = [
            [1, 2, 3],
            [4, 5, 6],
            [7, 8, 9]
        ]

        expected = [
            [1., 2., 3.],
            [0., -3., -6.],
            [0., 0., 0.]
        ]
        gauss = Gauss()
        self.assertEqual(expected, gauss.lu_decomposition(matrix)[1])

    def test_should_raise_value_error(self):
        matrix = [
            [1, 2, 3],
            [4, 5, 6]
        ]

        expected = ValueError

        gauss = Gauss()
        with self.assertRaises(expected):
            gauss.lu_decomposition(matrix)

    def test_should_return_ZeroDivisionError_when_10x10_and_not_invertable(self):
        matrix = [
            [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
            [11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
            [21, 22, 23, 24, 25, 26, 27, 28, 29, 30],
            [31, 32, 33, 34, 35, 36, 37, 38, 39, 40],
            [41, 42, 43, 44, 45, 46, 47, 48, 49, 50],
            [51, 52, 53, 54, 55, 56, 57, 58, 59, 60],
            [61, 62, 63, 64, 65, 66, 67, 68, 69, 70],
            [71, 72, 73, 74, 75, 76, 77, 78, 79, 80],
            [81, 82, 83, 84, 85, 86, 87, 88, 89, 90],
            [91, 92, 93, 94, 95, 96, 97, 98, 99, 100],
        ]

        expected = ZeroDivisionError

        gauss = Gauss()
        with self.assertRaises(expected):
            gauss.lu_decomposition(matrix)

    def test_should_return_L_matrix_when_10x10_and_invertible(self):
        matrix = [
            [2, 1, 3, 4, 5, 6, 7, 8, 9, 10],
            [1, 3, 2, 3, 4, 5, 6, 7, 8, 9],
            [3, 2, 2, 1, 3, 4, 5, 6, 7, 8],
            [4, 3, 1, 2, 2, 3, 4, 5, 6, 7],
            [5, 4, 3, 2, 3, 2, 3, 4, 5, 6],
            [6, 5, 4, 3, 2, 3, 2, 3, 4, 5],
            [7, 6, 5, 4, 3, 2, 3, 2, 3, 4],
            [8, 7, 6, 5, 4, 3, 2, 3, 2, 3],
            [9, 8, 7, 6, 5, 4, 3, 2, 3, 2],
            [10, 9, 8, 7, 6, 5, 4, 3, 2, 3]
        ]

        expected = [
            [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [0.5, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [1.5, 0.2, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [2.0, 0.4, 2.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [2.5, 0.6, 1.846153846153846, 0.25, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            [3.0, 0.8, 2.076923076923077, 0.25, 2.505376344086019, 1.0, 0.0, 0.0, 0.0, 0.0],
            [3.5, 1.0, 2.3076923076923075, 0.25, 2.892473118279568, 0.7461538461538464, 1.0, 0.0, 0.0, 0.0],
            [4.0, 1.2, 2.5384615384615383, 0.25, 3.2795698924731163, 0.8500000000000004, -0.41489361702128014, 1.0, 0.0,
             0.0],
            [4.5, 1.4, 2.769230769230769, 0.25, 3.6666666666666647, 0.9538461538461541, -0.4468085106383004,
             3.0185185185185044, 1.0, 0.0],
            [5.0, 1.6, 3.0, 0.25000000000000044, 4.0537634408602115, 1.0576923076923077, -0.4787234042553256,
             3.2962962962962856, 0.7492795389048976, 1.0]
        ]

        gauss = Gauss()
        self.assertEqual(expected, gauss.lu_decomposition(matrix)[0])

    def test_should_return_U_matrix_when_10x10_and_invertible(self):
        matrix = [
            [2, 1, 3, 4, 5, 6, 7, 8, 9, 10],
            [1, 3, 2, 3, 4, 5, 6, 7, 8, 9],
            [3, 2, 2, 1, 3, 4, 5, 6, 7, 8],
            [4, 3, 1, 2, 2, 3, 4, 5, 6, 7],
            [5, 4, 3, 2, 3, 2, 3, 4, 5, 6],
            [6, 5, 4, 3, 2, 3, 2, 3, 4, 5],
            [7, 6, 5, 4, 3, 2, 3, 2, 3, 4],
            [8, 7, 6, 5, 4, 3, 2, 3, 2, 3],
            [9, 8, 7, 6, 5, 4, 3, 2, 3, 2],
            [10, 9, 8, 7, 6, 5, 4, 3, 2, 3]
        ]

        expected = [
            [2.0, 1.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0],
            [0.0, 2.5, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0],
            [0.0, 0.0, -2.6, -5.2, -4.8, -5.4, -6.0, -6.6, -7.2, -7.8],
            [0.0, 0.0, 0.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0],
            [0.0, 0.0, 0.0, 0.0, -1.78846153846154, -4.48076923076923, -5.173076923076923, -5.865384615384617, -6.55769230769231, -7.25],
            [0.0, 0.0, 0.0, 0.0, 0.0, 5.591397849462352, 4.172043010752677, 4.752688172043001, 5.333333333333323, 5.913978494623638],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4461538461538437, -0.6000000000000036, -0.6461538461538447, -0.6923076923076961],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.1489361702127736, -3.4680851063829823, -3.7872340425531963],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.425925925925894, 4.814814814814769],
            [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4293948126801164]
        ]
        gauss = Gauss()
        self.assertEqual(expected, gauss.lu_decomposition(matrix)[1])

    def test_should_return_L_matrix_when_10x10_and_negative(self):
        matrix = [
            [-2, -11, -3, -6, -5, -6, -7, -8, -9, -10],
            [-1, -3, -2, -3, -4, -5, -6, -7, -8, -9],
            [-3, -2, -2, -1, -3, -4, -5, -6, -7, -8],
            [-4, -3, -1, -2, -2, -3, -4, -5, -6, -7],
            [-5, -4, -3, -2, -3, -2, -3, -4, -5, -6],
            [-6, -5, -4, -3, -2, -3, -2, -3, -4, -5],
            [-7, -6, -5, -4, -3, -2, -3, -2, -3, -4],
            [-8, -7, -6, -5, -4, -3, -2, -3, -2, -3],
            [-9, -8, -7, -6, -5, -4, -3, -2, -3, -2],
            [-10, -9, -8, -7, -6, -5, -4, -3, -2, -3]
        ]

        expected = [
            [1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
            [0.5, 1., 0., 0., 0., 0., 0., 0., 0., 0.],
            [1.5, 5.8, 1., 0., 0., 0., 0., 0., 0., 0.],
            [2., 7.6, 1.6296296296296298, 1., 0., 0., 0., 0., 0., 0.],
            [2.5, 9.4, 1.7037037037037035, 0.2073170731707311, 1., 0., 0., 0., 0., 0.],
            [3., 11.2, 1.9629629629629628, 0.23170731707317022, 2.826771653543296, 1., 0., 0., 0., 0.],
            [3.5, 13., 2.222222222222222, 0.25609756097560876, 3.362204724409438, 0.8102564102564089, 1., 0., 0., 0.],
            [4., 14.8, 2.4814814814814814, 0.2804878048780485, 3.897637795275579, 0.946153846153846, -0.3749999999999967, 1., 0., 0.],
            [4.5, 16.6, 2.7407407407407405, 0.304878048780487, 4.4330708661417235, 1.0820512820512833, -0.39583333333332216, 2.8777777777777507, 1., 0.],
            [5., 18.4, 2.9999999999999996, 0.32926829268292557, 4.968503937007854, 1.2179487179487138, -0.41666666666667046, 3.155555555555541, 0.7478260869565242, 1.] 
        ]

        gauss = Gauss()
        self.assertEqual(expected, gauss.lu_decomposition(matrix)[0])

    def test_should_return_U_matrix_when_10x10_and_negative(self):
        matrix = [
            [-2, -11, -3, -6, -5, -6, -7, -8, -9, -10],
            [-1, -3, -2, -3, -4, -5, -6, -7, -8, -9],
            [-3, -2, -2, -1, -3, -4, -5, -6, -7, -8],
            [-4, -3, -1, -2, -2, -3, -4, -5, -6, -7],
            [-5, -4, -3, -2, -3, -2, -3, -4, -5, -6],
            [-6, -5, -4, -3, -2, -3, -2, -3, -4, -5],
            [-7, -6, -5, -4, -3, -2, -3, -2, -3, -4],
            [-8, -7, -6, -5, -4, -3, -2, -3, -2, -3],
            [-9, -8, -7, -6, -5, -4, -3, -2, -3, -2],
            [-10, -9, -8, -7, -6, -5, -4, -3, -2, -3]
        ]

        expected = [
            [-2.0, -11.0, -3.0, -6.0, -5.0, -6.0, -7.0, -8.0, -9.0, -10.0],
            [0.0, 2.5, -0.5, 0.0, -1.5, -2.0, -2.5, -3.0, -3.5, -4.0],
            [0.0, 0.0, 5.4, 8., 13.2, 16.6, 20.0, 23.4, 26.8, 30.2],
            [0.0, 0.0, 0.0, -3.037037037037038, -2.1111111111111143, -2.8518518518518583, -3.5925925925925952, -4.333333333333336, -5.074074074074083, -5.814814814814817],
            [0.0, 0.0, 0.0, 0.0, 1.548780487804884, 4.109756097560975, 4.670731707317076, 5.2317073170731785, 5.792682926829267, 6.353658536585374],
            [0.0, 0.0, 0.0, 0.0, 0.0, -6.141732283464518, -4.629921259842469, -5.11811023622044, -5.60629921259836, -6.094488188976332],
            # so funktioniert der Test aber ab hier m√ºssten die ersten Zahlen alle 0.0 sein und nicht wie z.B. die die an der 2. Stelle stehen
            [0.0, 0.0, 1.7763568394002505e-15, 0.0, 0.0, 0.0, -1.4769230769230774, 0.6666666666666758, 0.8102564102564207, 0.953846153846154],
            [0.0, 0.0, 6.661338147750881e-16, 0.0, 0.0, 0.0, 0.0, 1.2500000000000093, 3.75000000000002, 4.250000000000002],
            [0.0, 0.0, 5.625129991434276e-16, 0.0, 0.0, 0.0, 0.0, 0.0, -6.388888888888838, -5.022222222222131],
            [0.0, 0.0, -1.7825354718850983e-15, 1.1102230246251565e-16, 0.0, -8.881784197001252e-16, 0.0, 0.0, 0.0, -1.4886956521738957]
        ]
        gauss = Gauss()
        self.assertEqual(expected, gauss.lu_decomposition(matrix)[1])    